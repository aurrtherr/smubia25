<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Relationship Analyzer | Overcooked</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-sans text-gray-800">

    <!-- Header -->
    <header class="bg-gradient-to-r from-purple-500 to-blue-500 text-white py-4 shadow fixed w-full top-0 z-50">
        <div class="container mx-auto flex justify-between items-center px-6">
            <h1 class="text-2xl font-bold"><a href="#">Text Relationship Analyzer</a></h1>
            <nav>
                <ul class="flex space-x-6">
                    <li><a href="#" class="hover:opacity-100 opacity-70 transition 0.2s">Home</a></li>
                    <li><a href="#about" class="hover:opacity-100 opacity-70 transition 0.2s">About</a></li>
                    <li><a href="#contact" class="hover:opacity-100 opacity-70 transition 0.2s">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-24">
        <!-- Upload Section -->
        <section id="upload" class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Upload Your Data</h2>
            <p class="mb-4 text-gray-600">Select an option to upload your data for analysis:</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- File Upload -->
                <div class="border border-gray-300 rounded-lg p-4 hover:shadow-lg transition">
                    <h3 class="text-lg font-medium mb-2">Upload File</h3>
                    <input type="file" id="fileUpload" accept=".txt,.pdf" class="block w-full text-sm text-gray-500 border border-gray-300 rounded-lg cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <p id="fileName" class="text-sm text-gray-500 mt-2"></p>
                </div>

                <!-- Text Input -->
                <div class="border border-gray-300 rounded-lg p-4 hover:shadow-lg transition">
                    <h3 class="text-lg font-medium mb-2">Enter Text</h3>
                    <textarea id="textInput" rows="5" class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>

                <!-- URL Input -->
                <div class="border border-gray-300 rounded-lg p-4 hover:shadow-lg transition">
                    <h3 class="text-lg font-medium mb-2">Enter URL</h3>
                    <input type="text" id="urlInput" class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter a web link">
                </div>
            </div>
            <button id="analyzeButton" class="mt-6 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                Analyze Now
            </button>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="mt-10 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Results</h2>
            <p class="mb-4 text-gray-600">Once analyzed, results will appear here with interactive visualizations and insights.</p>
            <div id="results" class="p-4 border border-gray-300 rounded-lg text-center text-gray-600">
                No data uploaded yet. Start by uploading your file, text, or URL.
            </div>
            <img id="kg-image" src="{{ url_for('static', filename='images/entity_network.png') }}" alt="Knowledge Graph">

            <script>
                setInterval(() => {
                    let img = document.getElementById("kg-image");
                    img.src = "{{ url_for('static', filename='images/entity_network.png') }}" + "?t=" + new Date().getTime();
                }, 5000);  // Refresh image every 5 seconds
            </script>
        </section>

        <!-- About Section -->
        <section id="about" class="mt-10 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4 font-bold">About This Project</h2>
            <p class="text-gray-700">
                The <b>Text Relationship Analyzer</b> is a tool developed by <b>Team Overcooked</b> to analyze relationships in textual data. It supports file uploads, plain text input, and URL-based text extraction. The tool processes and identifies connections between different pieces of text, making it useful for data analysis, research, and NLP-based applications.
            </p>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="mt-10 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Contact Us</h2>
            <p class="text-gray-700 mb-4">Have questions or need support? Reach out to us via email or use the contact form below:</p>
            <p class="text-gray-700 font-semibold mb-4">ðŸ“§ Email: <a href="mailto:contact@overcooked.dev" class="text-blue-600 hover:underline">contact@overcooked.dev</a></p>
            <form action="#" method="POST" class="grid grid-cols-1 gap-4">
                <input type="text" placeholder="Your Name" class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="email" placeholder="Your Email" class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                <textarea rows="5" placeholder="Your Message" class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Send Message</button>
            </form>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 text-center py-4 mt-10 text-sm text-gray-600">
        &copy; 2025 <span class="font-bold">Team Overcooked</span>. All rights reserved.
    </footer>

    <script>
        document.getElementById('fileUpload').addEventListener('change', function() {
            const fileNameDisplay = document.getElementById('fileName');
            if (this.files.length > 0) {
                fileNameDisplay.textContent = "Selected: " + this.files[0].name;
            } else {
                fileNameDisplay.textContent = "";
            }
        });

        document.getElementById('analyzeButton').addEventListener('click', async () => {
            const fileInput = document.getElementById('fileUpload').files[0];
            const textInput = document.getElementById('textInput').value.trim();
            const urlInput = document.getElementById('urlInput').value.trim();
            const resultsDiv = document.getElementById('results');

            resultsDiv.innerHTML = '<div class="animate-spin h-8 w-8 border-4 border-blue-500 border-t-transparent rounded-full mx-auto"></div>';

            const formData = new FormData();

            if (fileInput) {
                formData.append('file', fileInput);
            } else if (textInput) {
                formData.append('text', textInput);
            } else if (urlInput) {
                formData.append('url', urlInput);
            } else {
                resultsDiv.innerHTML = '<p class="text-red-500">Please upload a file, enter text, or provide a URL.</p>';
                return;
            }

            try {
                const response = await fetch('https://smubia25.onrender.com/analyze', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error('Failed to analyze data.');

                const data = await response.json();
                resultsDiv.innerHTML = `<div class="bg-gray-50 border border-gray-300 rounded-lg p-4">
                    <h3 class="font-medium text-lg mb-2">Analysis Results:</h3>
                    <pre class="text-left text-gray-700">${JSON.stringify(data, null, 2)}</pre>
                </div>`;
            } catch (error) {
                resultsDiv.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>
